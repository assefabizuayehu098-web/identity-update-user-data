<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ethio Online Works - Admin Panel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        /* Login Container */
        .login-container {
            display: flex;
            width: 100%;
            max-width: 1000px;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            min-height: 600px;
        }

        .login-left {
            flex: 1;
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            padding: 50px;
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .login-right {
            flex: 1;
            padding: 50px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo i {
            font-size: 32px;
        }

        .tagline {
            font-size: 18px;
            opacity: 0.9;
            margin-bottom: 40px;
        }

        .features {
            list-style: none;
        }

        .features li {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 16px;
        }

        .features i {
            font-size: 20px;
            color: #10b981;
            background: rgba(16, 185, 129, 0.1);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .login-form h2 {
            font-size: 28px;
            color: #1f2937;
            margin-bottom: 10px;
        }

        .login-subtitle {
            color: #6b7280;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            color: #374151;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: #4f46e5;
        }

        .btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(79, 70, 229, 0.2);
        }

        .btn-admin {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }

        .login-footer {
            text-align: center;
            margin-top: 20px;
            color: #6b7280;
        }

        .login-footer a {
            color: #4f46e5;
            text-decoration: none;
            font-weight: 500;
        }

        /* App Container */
        .app-container {
            display: none;
            width: 100%;
            max-width: 1200px;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            min-height: 700px;
        }

        /* Header */
        .app-header {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            padding: 20px 30px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .app-header .logo {
            margin: 0;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .balance {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .user-menu {
            position: relative;
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            background: white;
            color: #4f46e5;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
        }

        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            min-width: 200px;
            display: none;
            z-index: 1000;
        }

        .user-dropdown.show {
            display: block;
        }

        .dropdown-item {
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #374151;
            text-decoration: none;
            border-bottom: 1px solid #f3f4f6;
            transition: background 0.3s;
        }

        .dropdown-item:hover {
            background: #f9fafb;
        }

        .dropdown-item:last-child {
            border-bottom: none;
        }

        /* Navigation */
        .app-nav {
            background: #f9fafb;
            padding: 20px;
            border-right: 1px solid #e5e7eb;
            min-width: 250px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            color: #6b7280;
            text-decoration: none;
            border-radius: 10px;
            margin-bottom: 10px;
            transition: all 0.3s;
        }

        .nav-item:hover {
            background: #e5e7eb;
            color: #4f46e5;
        }

        .nav-item.active {
            background: #4f46e5;
            color: white;
        }

        .nav-item i {
            font-size: 20px;
            width: 24px;
        }

        /* Main Content */
        .app-main {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .page-title {
            font-size: 28px;
            color: #1f2937;
            margin-bottom: 10px;
        }

        .page-subtitle {
            color: #6b7280;
            margin-bottom: 30px;
        }

        /* Dashboard */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid #e5e7eb;
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 15px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #6b7280;
            font-size: 14px;
        }

        /* Works */
        .works-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .work-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid #e5e7eb;
            transition: transform 0.3s;
        }

        .work-card:hover {
            transform: translateY(-5px);
        }

        .work-header {
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
        }

        .work-title {
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 10px;
        }

        .work-reward {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            display: inline-block;
        }

        .work-body {
            padding: 20px;
        }

        .work-description {
            color: #6b7280;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .work-meta {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            font-size: 14px;
            color: #6b7280;
        }

        .work-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .work-actions {
            display: flex;
            gap: 10px;
        }

        .btn-small {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
        }

        .btn-small:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
        }

        /* Earnings */
        .earnings-summary {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .earnings-amount {
            font-size: 48px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .earnings-label {
            opacity: 0.9;
            margin-bottom: 20px;
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .action-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid #e5e7eb;
            cursor: pointer;
            transition: all 0.3s;
        }

        .action-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .action-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin: 0 auto 15px;
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
        }

        .action-title {
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 10px;
        }

        .action-desc {
            color: #6b7280;
            font-size: 14px;
        }

        /* Account */
        .profile-section {
            display: flex;
            gap: 30px;
            margin-bottom: 30px;
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            color: white;
            font-weight: bold;
        }

        .profile-info {
            flex: 1;
        }

        .profile-name {
            font-size: 24px;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 10px;
        }

        .profile-username {
            color: #6b7280;
            margin-bottom: 20px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .info-item {
            background: #f9fafb;
            padding: 15px;
            border-radius: 10px;
        }

        .info-label {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 5px;
        }

        .info-value {
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
        }

        /* Admin Panel */
        .admin-container {
            display: none;
        }

        .admin-header {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }

        .admin-nav {
            background: #fef3c7;
        }

        .admin-nav .nav-item.active {
            background: #f59e0b;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
            color: #1f2937;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: #6b7280;
            cursor: pointer;
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 10px;
            padding: 15px 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 3000;
            transform: translateX(400px);
            transition: transform 0.3s;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            border-left: 4px solid #10b981;
        }

        .notification.error {
            border-left: 4px solid #ef4444;
        }

        .notification.info {
            border-left: 4px solid #3b82f6;
        }

        .notification-icon {
            font-size: 24px;
        }

        .notification.success .notification-icon {
            color: #10b981;
        }

        .notification.error .notification-icon {
            color: #ef4444;
        }

        .notification.info .notification-icon {
            color: #3b82f6;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .login-container {
                flex-direction: column;
            }

            .login-left {
                padding: 30px;
            }

            .login-right {
                padding: 30px;
            }

            .app-container {
                flex-direction: column;
            }

            .app-nav {
                min-width: auto;
                border-right: none;
                border-bottom: 1px solid #e5e7eb;
            }

            .nav-list {
                display: flex;
                overflow-x: auto;
                gap: 10px;
            }

            .nav-item {
                white-space: nowrap;
                margin-bottom: 0;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .works-grid {
                grid-template-columns: 1fr;
            }

            .profile-section {
                flex-direction: column;
                text-align: center;
            }

            .user-info {
                flex-direction: column;
                gap: 10px;
            }

            .balance {
                order: -1;
            }
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div class="login-container" id="login-container">
        <div class="login-left">
            <div class="logo">
                <i class="fas fa-briefcase"></i>
                Ethio Online Works
            </div>
            <div class="tagline">
                Earn money by completing simple online tasks
            </div>
            <ul class="features">
                <li>
                    <i class="fas fa-check"></i>
                    <div>
                        <strong>Easy Tasks</strong>
                        <div style="font-size: 14px; opacity: 0.8;">Complete simple tasks and earn</div>
                    </div>
                </li>
                <li>
                    <i class="fas fa-bolt"></i>
                    <div>
                        <strong>Fast Payments</strong>
                        <div style="font-size: 14px; opacity: 0.8;">Withdraw your earnings quickly</div>
                    </div>
                </li>
                <li>
                    <i class="fas fa-shield-alt"></i>
                    <div>
                        <strong>Secure Platform</strong>
                        <div style="font-size: 14px; opacity: 0.8;">Your data is protected</div>
                    </div>
                </li>
            </ul>
        </div>
        <div class="login-right">
            <div class="login-form">
                <h2>Welcome Back</h2>
                <div class="login-subtitle">Sign in to your account</div>
                
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" class="form-control" placeholder="Enter your username">
                </div>
                
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" class="form-control" placeholder="Enter your password">
                    <div style="font-size: 12px; color: #6b7280; margin-top: 5px;">
                        <i class="fas fa-info-circle"></i> Use "admin" as password for admin access
                    </div>
                </div>
                
                <button class="btn" onclick="login()">Sign In</button>
                <button class="btn btn-admin" onclick="showSignup()">Create Account</button>
                
                <div class="login-footer">
                    <p>By signing in, you agree to our <a href="#">Terms of Service</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Signup Page -->
    <div class="login-container" id="signup-container" style="display: none;">
        <div class="login-left">
            <div class="logo">
                <i class="fas fa-user-plus"></i>
                Create Account
            </div>
            <div class="tagline">
                Join thousands earning online
            </div>
            <ul class="features">
                <li>
                    <i class="fas fa-gift"></i>
                    <div>
                        <strong>Welcome Bonus</strong>
                        <div style="font-size: 14px; opacity: 0.8;">Get 50 ETB when you sign up</div>
                    </div>
                </li>
                <li>
                    <i class="fas fa-users"></i>
                    <div>
                        <strong>Referral Program</strong>
                        <div style="font-size: 14px; opacity: 0.8;">Earn 10% from referrals</div>
                    </div>
                </li>
                <li>
                    <i class="fas fa-trophy"></i>
                    <div>
                        <strong>Level System</strong>
                        <div style="font-size: 14px; opacity: 0.8;">Higher levels, more earnings</div>
                    </div>
                </li>
            </ul>
        </div>
        <div class="login-right">
            <div class="login-form">
                <h2>Create Account</h2>
                <div class="login-subtitle">Start your earning journey</div>
                
                <div class="form-group">
                    <label for="signup-name">Full Name</label>
                    <input type="text" id="signup-name" class="form-control" placeholder="Enter your full name">
                </div>
                
                <div class="form-group">
                    <label for="signup-username">Username</label>
                    <input type="text" id="signup-username" class="form-control" placeholder="Choose a username">
                </div>
                
                <div class="form-group">
                    <label for="signup-password">Password</label>
                    <input type="password" id="signup-password" class="form-control" placeholder="Create a password">
                </div>
                
                <div class="form-group">
                    <label for="signup-phone">Phone Number</label>
                    <input type="tel" id="signup-phone" class="form-control" placeholder="09XX XXX XXX">
                </div>
                
                <button class="btn" onclick="signup()">Create Account</button>
                <button class="btn btn-secondary" onclick="showLogin()" style="background: #e5e7eb; color: #374151; margin-top: 10px;">
                    Back to Login
                </button>
            </div>
        </div>
    </div>

    <!-- User App -->
    <div class="app-container" id="app-container">
        <div class="app-header">
            <div class="logo">
                <i class="fas fa-briefcase"></i>
                Ethio Online Works
            </div>
            <div class="user-info">
                <div class="balance">
                    <i class="fas fa-wallet"></i>
                    <span id="user-balance">0 ETB</span>
                </div>
                <div class="user-menu">
                    <div class="user-avatar" onclick="toggleUserMenu()" id="user-avatar">
                        U
                    </div>
                    <div class="user-dropdown" id="user-dropdown">
                        <a href="#" class="dropdown-item" onclick="showPage('account')">
                            <i class="fas fa-user"></i> Profile
                        </a>
                        <a href="#" class="dropdown-item" onclick="showPage('earnings')">
                            <i class="fas fa-wallet"></i> Wallet
                        </a>
                        <a href="#" class="dropdown-item" onclick="showSettings()">
                            <i class="fas fa-cog"></i> Settings
                        </a>
                        <hr>
                        <a href="#" class="dropdown-item" onclick="logout()">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="app-content" style="display: flex; height: calc(100% - 80px);">
            <div class="app-nav">
                <div class="nav-list">
                    <a href="#" class="nav-item active" onclick="showPage('dashboard')">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                    </a>
                    <a href="#" class="nav-item" onclick="showPage('works')">
                        <i class="fas fa-tasks"></i>
                        <span>Available Works</span>
                    </a>
                    <a href="#" class="nav-item" onclick="showPage('earnings')">
                        <i class="fas fa-wallet"></i>
                        <span>Earnings</span>
                    </a>
                    <a href="#" class="nav-item" onclick="showPage('history')">
                        <i class="fas fa-history"></i>
                        <span>History</span>
                    </a>
                    <a href="#" class="nav-item" onclick="showPage('referrals')">
                        <i class="fas fa-users"></i>
                        <span>Referrals</span>
                    </a>
                    <a href="#" class="nav-item" onclick="showPage('account')">
                        <i class="fas fa-user"></i>
                        <span>Account</span>
                    </a>
                </div>
            </div>
            
            <div class="app-main" id="app-main">
                <!-- Content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div class="app-container admin-container" id="admin-container">
        <div class="app-header admin-header">
            <div class="logo">
                <i class="fas fa-shield-alt"></i>
                Admin Panel
            </div>
            <div class="user-info">
                <div class="balance">
                    <i class="fas fa-cog"></i>
                    <span>Admin Controls</span>
                </div>
                <div class="user-menu">
                    <div class="user-avatar" onclick="toggleAdminMenu()" style="background: #f59e0b;">
                        A
                    </div>
                    <div class="user-dropdown" id="admin-dropdown">
                        <a href="#" class="dropdown-item" onclick="showAdminPage('users')">
                            <i class="fas fa-users"></i> Users
                        </a>
                        <a href="#" class="dropdown-item" onclick="showAdminPage('works')">
                            <i class="fas fa-tasks"></i> Works
                        </a>
                        <a href="#" class="dropdown-item" onclick="showAdminPage('transactions')">
                            <i class="fas fa-exchange-alt"></i> Transactions
                        </a>
                        <a href="#" class="dropdown-item" onclick="showAdminPage('approvals')">
                            <i class="fas fa-check-circle"></i> Approvals
                        </a>
                        <hr>
                        <a href="#" class="dropdown-item" onclick="logout()">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="app-content" style="display: flex; height: calc(100% - 80px);">
            <div class="app-nav admin-nav">
                <div class="nav-list">
                    <a href="#" class="nav-item active" onclick="showAdminPage('dashboard')">
                        <i class="fas fa-chart-bar"></i>
                        <span>Dashboard</span>
                    </a>
                    <a href="#" class="nav-item" onclick="showAdminPage('users')">
                        <i class="fas fa-users"></i>
                        <span>Users</span>
                    </a>
                    <a href="#" class="nav-item" onclick="showAdminPage('works')">
                        <i class="fas fa-tasks"></i>
                        <span>Works</span>
                    </a>
                    <a href="#" class="nav-item" onclick="showAdminPage('transactions')">
                        <i class="fas fa-exchange-alt"></i>
                        <span>Transactions</span>
                    </a>
                    <a href="#" class="nav-item" onclick="showAdminPage('approvals')">
                        <i class="fas fa-check-circle"></i>
                        <span>Approvals</span>
                    </a>
                    <a href="#" class="nav-item" onclick="showAdminPage('settings')">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </a>
                </div>
            </div>
            
            <div class="app-main" id="admin-main">
                <!-- Admin content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="modal-title">Modal Title</div>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body" id="modal-body">
                <!-- Modal content -->
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <div class="notification-icon">
            <i class="fas fa-info-circle"></i>
        </div>
        <div class="notification-content">
            <div class="notification-title" id="notification-title">Notification</div>
            <div class="notification-message" id="notification-message">Message here</div>
        </div>
    </div>

    <script>
        // Data Storage
        const STORAGE_KEYS = {
            USERS: 'ethio_works_users',
            WORKS: 'ethio_works_works',
            TRANSACTIONS: 'ethio_works_transactions',
            APPROVALS: 'ethio_works_approvals',
            CURRENT_USER: 'ethio_works_current_user'
        };

        // Sample Data
        const DEFAULT_USERS = [
            {
                id: 1,
                name: "Demo User",
                username: "demo",
                password: "demo123",
                phone: "0912345678",
                balance: 850,
                level: 3,
                worksCompleted: 12,
                joinDate: "2024-01-15",
                status: "active",
                referralCode: "REF123456",
                referrals: 3
            },
            {
                id: 2,
                name: "Admin User",
                username: "admin",
                password: "admin",
                phone: "0987654321",
                balance: 5000,
                level: 10,
                worksCompleted: 50,
                joinDate: "2024-01-01",
                status: "active",
                referralCode: "ADMIN123",
                referrals: 10,
                isAdmin: true
            }
        ];

        const DEFAULT_WORKS = [
            {
                id: 1,
                title: "Like YouTube Videos",
                description: "Watch and like 10 technology videos on YouTube. Provide screenshots as proof.",
                reward: 25,
                difficulty: "Easy",
                available: 50,
                completed: 150,
                status: "active",
                category: "social",
                requirements: "Smartphone or computer with internet",
                time: "5-10 minutes"
            },
            {
                id: 2,
                title: "Follow Instagram Page",
                description: "Follow our Instagram page and like 5 recent posts.",
                reward: 35,
                difficulty: "Easy",
                available: 100,
                completed: 80,
                status: "active",
                category: "social",
                requirements: "Instagram account",
                time: "3-5 minutes"
            }
        ];

        const DEFAULT_TRANSACTIONS = [
            {
                id: 1,
                userId: 1,
                type: "deposit",
                amount: 500,
                status: "completed",
                date: "2024-03-10 10:30:00",
                method: "Telebirr"
            },
            {
                id: 2,
                userId: 1,
                type: "work",
                amount: 25,
                status: "completed",
                date: "2024-03-10 11:15:00",
                workId: 1,
                workTitle: "Like YouTube Videos"
            }
        ];

        // Initialize Data
        function initializeData() {
            if (!localStorage.getItem(STORAGE_KEYS.USERS)) {
                localStorage.setItem(STORAGE_KEYS.USERS, JSON.stringify(DEFAULT_USERS));
            }
            if (!localStorage.getItem(STORAGE_KEYS.WORKS)) {
                localStorage.setItem(STORAGE_KEYS.WORKS, JSON.stringify(DEFAULT_WORKS));
            }
            if (!localStorage.getItem(STORAGE_KEYS.TRANSACTIONS)) {
                localStorage.setItem(STORAGE_KEYS.TRANSACTIONS, JSON.stringify(DEFAULT_TRANSACTIONS));
            }
        }

        // Get data from storage
        function getUsers() {
            return JSON.parse(localStorage.getItem(STORAGE_KEYS.USERS)) || [];
        }

        function getWorks() {
            return JSON.parse(localStorage.getItem(STORAGE_KEYS.WORKS)) || [];
        }

        function getTransactions() {
            return JSON.parse(localStorage.getItem(STORAGE_KEYS.TRANSACTIONS)) || [];
        }

        function getApprovals() {
            return JSON.parse(localStorage.getItem(STORAGE_KEYS.APPROVALS)) || [];
        }

        // Save data to storage
        function saveUsers(users) {
            localStorage.setItem(STORAGE_KEYS.USERS, JSON.stringify(users));
        }

        function saveWorks(works) {
            localStorage.setItem(STORAGE_KEYS.WORKS, JSON.stringify(works));
        }

        function saveTransactions(transactions) {
            localStorage.setItem(STORAGE_KEYS.TRANSACTIONS, JSON.stringify(transactions));
        }

        function saveApprovals(approvals) {
            localStorage.setItem(STORAGE_KEYS.APPROVALS, JSON.stringify(approvals));
        }

        // Current user
        let currentUser = null;

        // Show notification
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            const title = document.getElementById('notification-title');
            const msg = document.getElementById('notification-message');
            
            notification.className = `notification ${type} show`;
            title.textContent = type.charAt(0).toUpperCase() + type.slice(1);
            msg.textContent = message;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Show modal
        function showModal(title, content) {
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-body').innerHTML = content;
            document.getElementById('modal').classList.add('show');
        }

        function closeModal() {
            document.getElementById('modal').classList.remove('show');
        }

        // Toggle user menu
        function toggleUserMenu() {
            document.getElementById('user-dropdown').classList.toggle('show');
        }

        function toggleAdminMenu() {
            document.getElementById('admin-dropdown').classList.toggle('show');
        }

        // Close menus when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.user-menu')) {
                document.getElementById('user-dropdown').classList.remove('show');
            }
            if (!e.target.closest('.user-menu')) {
                document.getElementById('admin-dropdown').classList.remove('show');
            }
        });

        // Login functions
        function showLogin() {
            document.getElementById('login-container').style.display = 'flex';
            document.getElementById('signup-container').style.display = 'none';
        }

        function showSignup() {
            document.getElementById('login-container').style.display = 'none';
            document.getElementById('signup-container').style.display = 'flex';
        }

        function login() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            
            if (!username || !password) {
                showNotification('Please enter username and password', 'error');
                return;
            }
            
            const users = getUsers();
            const user = users.find(u => u.username === username && u.password === password);
            
            if (user) {
                if (user.isAdmin) {
                    showAdminPanel(user);
                    showNotification('Welcome to Admin Panel!', 'success');
                } else {
                    showApp(user);
                    showNotification('Login successful!', 'success');
                }
            } else {
                showNotification('Invalid username or password', 'error');
            }
        }

        function signup() {
            const name = document.getElementById('signup-name').value.trim();
            const username = document.getElementById('signup-username').value.trim();
            const password = document.getElementById('signup-password').value.trim();
            const phone = document.getElementById('signup-phone').value.trim();
            
            if (!name || !username || !password || !phone) {
                showNotification('Please fill all fields', 'error');
                return;
            }
            
            let users = getUsers();
            
            if (users.find(u => u.username === username)) {
                showNotification('Username already exists', 'error');
                return;
            }
            
            if (password.length < 6) {
                showNotification('Password must be at least 6 characters', 'error');
                return;
            }
            
            const newUser = {
                id: users.length > 0 ? Math.max(...users.map(u => u.id)) + 1 : 1,
                name,
                username,
                password,
                phone,
                balance: 50, // Welcome bonus
                level: 1,
                worksCompleted: 0,
                joinDate: new Date().toISOString().split('T')[0],
                status: "active",
                referralCode: "REF" + Math.floor(100000 + Math.random() * 900000),
                referrals: 0
            };
            
            users.push(newUser);
            saveUsers(users);
            
            showApp(newUser);
            showNotification('Account created successfully! You received 50 ETB welcome bonus.', 'success');
        }

        function showApp(user) {
            currentUser = user;
            localStorage.setItem(STORAGE_KEYS.CURRENT_USER, JSON.stringify(user));
            
            document.getElementById('login-container').style.display = 'none';
            document.getElementById('signup-container').style.display = 'none';
            document.getElementById('app-container').style.display = 'block';
            document.getElementById('admin-container').style.display = 'none';
            
            updateUserInfo();
            showPage('dashboard');
        }

        function showAdminPanel(admin) {
            currentUser = admin;
            localStorage.setItem(STORAGE_KEYS.CURRENT_USER, JSON.stringify(admin));
            
            document.getElementById('login-container').style.display = 'none';
            document.getElementById('signup-container').style.display = 'none';
            document.getElementById('app-container').style.display = 'none';
            document.getElementById('admin-container').style.display = 'block';
            
            showAdminPage('dashboard');
        }

        function updateUserInfo() {
            if (!currentUser) return;
            
            document.getElementById('user-balance').textContent = currentUser.balance + ' ETB';
            document.getElementById('user-avatar').textContent = currentUser.name.charAt(0).toUpperCase();
            document.getElementById('user-avatar').style.background = getRandomColor();
        }

        function getRandomColor() {
            const colors = ['#4f46e5', '#7c3aed', '#10b981', '#f59e0b', '#ef4444'];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        // Navigation
        function showPage(page) {
            // Update active nav item
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.closest('.nav-item').classList.add('active');
            
            const content = document.getElementById('app-main');
            
            switch(page) {
                case 'dashboard':
                    loadDashboard();
                    break;
                case 'works':
                    loadWorks();
                    break;
                case 'earnings':
                    loadEarnings();
                    break;
                case 'history':
                    loadHistory();
                    break;
                case 'referrals':
                    loadReferrals();
                    break;
                case 'account':
                    loadAccount();
                    break;
            }
        }

        function showAdminPage(page) {
            // Update active nav item
            document.querySelectorAll('.admin-container .nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.closest('.nav-item').classList.add('active');
            
            switch(page) {
                case 'dashboard':
                    loadAdminDashboard();
                    break;
                case 'users':
                    loadAdminUsers();
                    break;
                case 'works':
                    loadAdminWorks();
                    break;
                case 'transactions':
                    loadAdminTransactions();
                    break;
                case 'approvals':
                    loadAdminApprovals();
                    break;
                case 'settings':
                    loadAdminSettings();
                    break;
            }
        }

        // User Pages
        function loadDashboard() {
            const content = `
                <div class="page-title">Dashboard</div>
                <div class="page-subtitle">Welcome back, ${currentUser.name}</div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(79, 70, 229, 0.1); color: #4f46e5;">
                            <i class="fas fa-wallet"></i>
                        </div>
                        <div class="stat-value">${currentUser.balance} ETB</div>
                        <div class="stat-label">Available Balance</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(16, 185, 129, 0.1); color: #10b981;">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div class="stat-value">Level ${currentUser.level}</div>
                        <div class="stat-label">Current Level</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(245, 158, 11, 0.1); color: #f59e0b;">
                            <i class="fas fa-tasks"></i>
                        </div>
                        <div class="stat-value">${currentUser.worksCompleted}</div>
                        <div class="stat-label">Works Completed</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(239, 68, 68, 0.1); color: #ef4444;">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-value">${currentUser.referrals}</div>
                        <div class="stat-label">Referrals</div>
                    </div>
                </div>
                
                <div style="margin-top: 30px;">
                    <div style="font-size: 20px; font-weight: 600; margin-bottom: 20px;">Quick Actions</div>
                    <div class="actions-grid">
                        <div class="action-card" onclick="showPage('works')">
                            <div class="action-icon">
                                <i class="fas fa-play-circle"></i>
                            </div>
                            <div class="action-title">Start Earning</div>
                            <div class="action-desc">Complete tasks to earn money</div>
                        </div>
                        
                        <div class="action-card" onclick="showPage('earnings')">
                            <div class="action-icon">
                                <i class="fas fa-download"></i>
                            </div>
                            <div class="action-title">Withdraw</div>
                            <div class="action-desc">Withdraw your earnings</div>
                        </div>
                        
                        <div class="action-card" onclick="showPage('referrals')">
                            <div class="action-icon">
                                <i class="fas fa-share-alt"></i>
                            </div>
                            <div class="action-title">Invite Friends</div>
                            <div class="action-desc">Earn from referrals</div>
                        </div>
                        
                        <div class="action-card" onclick="showPage('account')">
                            <div class="action-icon">
                                <i class="fas fa-user-cog"></i>
                            </div>
                            <div class="action-title">Profile</div>
                            <div class="action-desc">Manage your account</div>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('app-main').innerHTML = content;
        }

        function loadWorks() {
            const works = getWorks();
            const activeWorks = works.filter(w => w.status === 'active');
            
            let worksHTML = '';
            
            if (activeWorks.length === 0) {
                worksHTML = `
                    <div style="text-align: center; padding: 50px 20px;">
                        <div style="font-size: 48px; color: #e5e7eb; margin-bottom: 20px;">
                            <i class="fas fa-tasks"></i>
                        </div>
                        <div style="font-size: 18px; color: #6b7280; margin-bottom: 10px;">
                            No works available at the moment
                        </div>
                        <div style="color: #9ca3af;">
                            Check back later for new tasks
                        </div>
                    </div>
                `;
            } else {
                worksHTML = `
                    <div class="works-grid">
                        ${activeWorks.map(work => `
                            <div class="work-card">
                                <div class="work-header">
                                    <div class="work-title">${work.title}</div>
                                    <div class="work-reward">${work.reward} ETB</div>
                                </div>
                                <div class="work-body">
                                    <div class="work-description">
                                        ${work.description}
                                    </div>
                                    <div class="work-meta">
                                        <span>
                                            <i class="fas fa-signal"></i>
                                            ${work.difficulty}
                                        </span>
                                        <span>
                                            <i class="fas fa-clock"></i>
                                            ${work.time}
                                        </span>
                                        <span>
                                            <i class="fas fa-box"></i>
                                            ${work.available} available
                                        </span>
                                    </div>
                                    <div class="work-actions">
                                        <button class="btn-small btn-secondary" onclick="viewWorkDetails(${work.id})">
                                            Details
                                        </button>
                                        <button class="btn-small btn-primary" onclick="startWork(${work.id})">
                                            Start Work
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            const content = `
                <div class="page-title">Available Works</div>
                <div class="page-subtitle">Complete tasks to earn money</div>
                ${worksHTML}
            `;
            
            document.getElementById('app-main').innerHTML = content;
        }

        function viewWorkDetails(workId) {
            const works = getWorks();
            const work = works.find(w => w.id === workId);
            
            if (!work) return;
            
            showModal(work.title, `
                <div style="margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <div style="font-size: 24px; font-weight: 600; color: #4f46e5;">${work.reward} ETB</div>
                        <div style="background: #f3f4f6; color: #374151; padding: 5px 15px; border-radius: 20px; font-size: 14px;">
                            ${work.difficulty}
                        </div>
                    </div>
                    
                    <p style="color: #6b7280; margin-bottom: 20px;">${work.description}</p>
                    
                    <div style="background: #f9fafb; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                        <div style="font-size: 14px; color: #6b7280; margin-bottom: 8px;">Requirements:</div>
                        <ul style="color: #6b7280; font-size: 14px; padding-left: 20px;">
                            <li>${work.requirements}</li>
                            <li>Screenshot proof required</li>
                            <li>Follow instructions carefully</li>
                            <li>Internet connection required</li>
                        </ul>
                    </div>
                    
                    <div style="display: flex; gap: 15px; font-size: 14px; color: #6b7280; margin-bottom: 20px;">
                        <span><i class="fas fa-clock"></i> Time: ${work.time}</span>
                        <span><i class="fas fa-box"></i> Available: ${work.available}</span>
                        <span><i class="fas fa-tag"></i> ${work.category}</span>
                    </div>
                </div>
                
                <button class="btn" onclick="startWork(${work.id}); closeModal();">
                    Start Work Now
                </button>
            `);
        }

        function startWork(workId) {
            const works = getWorks();
            const work = works.find(w => w.id === workId);
            
            if (!work || work.available <= 0) {
                showNotification('No more slots available for this work', 'error');
                return;
            }
            
            showModal('Work Instructions', `
                <div style="margin-bottom: 20px;">
                    <p style="color: #6b7280; margin-bottom: 15px;">Please follow these steps:</p>
                    <ol style="color: #6b7280; padding-left: 20px;">
                        <li style="margin-bottom: 10px;">Complete the work as described</li>
                        <li style="margin-bottom: 10px;">Take clear screenshots as proof</li>
                        <li style="margin-bottom: 10px;">Submit screenshots for verification</li>
                        <li>Wait for admin approval</li>
                    </ol>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; color: #374151; margin-bottom: 8px;">Upload Screenshots:</label>
                    <input type="file" id="screenshot-upload" accept="image/*" multiple style="width: 100%; padding: 10px; border: 2px dashed #e5e7eb; border-radius: 8px;">
                </div>
                
                <button class="btn" onclick="submitWork(${workId})">
                    Submit for Verification
                </button>
            `);
        }

        function submitWork(workId) {
            const works = getWorks();
            const workIndex = works.findIndex(w => w.id === workId);
            
            if (workIndex === -1 || works[workIndex].available <= 0) {
                showNotification('Work no longer available', 'error');
                closeModal();
                return;
            }
            
            // Update work availability
            works[workIndex].available -= 1;
            works[workIndex].completed += 1;
            saveWorks(works);
            
            // Create approval request
            const approvals = getApprovals();
            const newApproval = {
                id: approvals.length > 0 ? Math.max(...approvals.map(a => a.id)) + 1 : 1,
                userId: currentUser.id,
                username: currentUser.username,
                type: 'work',
                workId: workId,
                workTitle: works[workIndex].title,
                reward: works[workIndex].reward,
                status: 'pending',
                date: new Date().toISOString().split('T')[0],
                submittedAt: new Date().toISOString().replace('T', ' ').substr(0, 19)
            };
            
            approvals.push(newApproval);
            saveApprovals(approvals);
            
            closeModal();
            showNotification('Work submitted for verification! Admin will review your submission.', 'success');
            showPage('works');
        }

        function loadEarnings() {
            const content = `
                <div class="page-title">Earnings</div>
                <div class="page-subtitle">Manage your money</div>
                
                <div class="earnings-summary">
                    <div class="earnings-amount">${currentUser.balance} ETB</div>
                    <div class="earnings-label">Available Balance</div>
                    <div style="font-size: 14px; opacity: 0.8;">
                        Minimum withdrawal: 500 ETB
                    </div>
                </div>
                
                <div style="margin-bottom: 30px;">
                    <div style="font-size: 20px; font-weight: 600; margin-bottom: 20px;">Quick Actions</div>
                    <div class="actions-grid">
                        <div class="action-card" onclick="deposit()">
                            <div class="action-icon">
                                <i class="fas fa-plus-circle"></i>
                            </div>
                            <div class="action-title">Deposit</div>
                            <div class="action-desc">Add money to your account</div>
                        </div>
                        
                        <div class="action-card" onclick="withdraw()">
                            <div class="action-icon">
                                <i class="fas fa-download"></i>
                            </div>
                            <div class="action-title">Withdraw</div>
                            <div class="action-desc">Withdraw your earnings</div>
                        </div>
                        
                        <div class="action-card" onclick="showTransactionHistory()">
                            <div class="action-icon">
                                <i class="fas fa-history"></i>
                            </div>
                            <div class="action-title">History</div>
                            <div class="action-desc">View transaction history</div>
                        </div>
                        
                        <div class="action-card" onclick="showPage('referrals')">
                            <div class="action-icon">
                                <i class="fas fa-gift"></i>
                            </div>
                            <div class="action-title">Bonus</div>
                            <div class="action-desc">Referral earnings</div>
                        </div>
                    </div>
                </div>
                
                <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.05);">
                    <div style="font-size: 18px; font-weight: 600; margin-bottom: 20px;">Earnings Statistics</div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                        <div style="padding: 15px; background: #f9fafb; border-radius: 10px;">
                            <div style="color: #6b7280; font-size: 14px; margin-bottom: 5px;">Total Earned</div>
                            <div style="font-size: 24px; font-weight: 600; color: #10b981;">${currentUser.balance + 500} ETB</div>
                        </div>
                        
                        <div style="padding: 15px; background: #f9fafb; border-radius: 10px;">
                            <div style="color: #6b7280; font-size: 14px; margin-bottom: 5px;">Works Completed</div>
                            <div style="font-size: 24px; font-weight: 600; color: #4f46e5;">${currentUser.worksCompleted}</div>
                        </div>
                        
                        <div style="padding: 15px; background: #f9fafb; border-radius: 10px;">
                            <div style="color: #6b7280; font-size: 14px; margin-bottom: 5px;">Avg per Work</div>
                            <div style="font-size: 24px; font-weight: 600; color: #f59e0b;">
                                ${currentUser.worksCompleted > 0 ? Math.round((currentUser.balance + 500) / currentUser.worksCompleted) : 0} ETB
                            </div>
                        </div>
                        
                        <div style="padding: 15px; background: #f9fafb; border-radius: 10px;">
                            <div style="color: #6b7280; font-size: 14px; margin-bottom: 5px;">Withdrawal Ready</div>
                            <div style="font-size: 24px; font-weight: 600; color: ${currentUser.balance >= 500 ? '#10b981' : '#ef4444'}">
                                ${currentUser.balance >= 500 ? 'Yes' : 'No'}
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('app-main').innerHTML = content;
        }

        function deposit() {
            showModal('Deposit Money', `
                <div class="form-group">
                    <label>Amount (ETB)</label>
                    <input type="number" id="deposit-amount" class="form-control" placeholder="Minimum 100 ETB" min="100">
                </div>
                
                <div class="form-group">
                    <label>Payment Method</label>
                    <select id="deposit-method" class="form-control">
                        <option value="telebirr">Telebirr</option>
                        <option value="cbe">CBE Birr</option>
                        <option value="abyssinia">Abyssinia Bank</option>
                        <option value="amole">Amole</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="tel" id="deposit-phone" class="form-control" placeholder="09XX XXX XXX" value="${currentUser.phone}">
                </div>
                
                <button class="btn" onclick="submitDeposit()">
                    Continue to Payment
                </button>
            `);
        }

        function submitDeposit() {
            const amount = parseInt(document.getElementById('deposit-amount').value) || 0;
            const method = document.getElementById('deposit-method').value;
            const phone = document.getElementById('deposit-phone').value;
            
            if (amount < 100) {
                showNotification('Minimum deposit is 100 ETB', 'error');
                return;
            }
            
            if (!phone || phone.length < 10) {
                showNotification('Please enter valid phone number', 'error');
                return;
            }
            
            const transactions = getTransactions();
            const newTransaction = {
                id: transactions.length > 0 ? Math.max(...transactions.map(t => t.id)) + 1 : 1,
                userId: currentUser.id,
                type: 'deposit',
                amount: amount,
                status: 'pending',
                date: new Date().toISOString().replace('T', ' ').substr(0, 19),
                method: method,
                phone: phone
            };
            
            transactions.push(newTransaction);
            saveTransactions(transactions);
            
            // Create approval for admin
            const approvals = getApprovals();
            approvals.push({
                id: approvals.length > 0 ? Math.max(...approvals.map(a => a.id)) + 1 : 1,
                userId: currentUser.id,
                username: currentUser.username,
                type: 'deposit',
                amount: amount,
                method: method,
                phone: phone,
                status: 'pending',
                date: new Date().toISOString().split('T')[0],
                submittedAt: new Date().toISOString().replace('T', ' ').substr(0, 19)
            });
            
            saveApprovals(approvals);
            
            closeModal();
            showNotification(`Deposit request of ${amount} ETB submitted for approval`, 'success');
        }

        function withdraw() {
            if (currentUser.balance < 500) {
                showNotification('Minimum withdrawal is 500 ETB', 'error');
                return;
            }
            
            showModal('Withdraw Money', `
                <div style="text-align: center; margin-bottom: 20px;">
                    <div style="font-size: 14px; color: #6b7280;">Available Balance</div>
                    <div style="font-size: 32px; font-weight: 700; color: #4f46e5;">${currentUser.balance} ETB</div>
                </div>
                
                <div class="form-group">
                    <label>Amount (ETB)</label>
                    <input type="number" id="withdraw-amount" class="form-control" placeholder="Minimum 500 ETB" 
                           min="500" max="${currentUser.balance}">
                </div>
                
                <div class="form-group">
                    <label>Account Type</label>
                    <select id="withdraw-method" class="form-control">
                        <option value="telebirr">Telebirr</option>
                        <option value="bank">Bank Account</option>
                        <option value="cbe">CBE Account</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Account Number</label>
                    <input type="text" id="withdraw-account" class="form-control" placeholder="09XX XXX XXX or Bank Account">
                </div>
                
                <button class="btn" onclick="submitWithdraw()">
                    Request Withdrawal
                </button>
            `);
        }

        function submitWithdraw() {
            const amount = parseInt(document.getElementById('withdraw-amount').value) || 0;
            const method = document.getElementById('withdraw-method').value;
            const account = document.getElementById('withdraw-account').value;
            
            if (amount < 500) {
                showNotification('Minimum withdrawal is 500 ETB', 'error');
                return;
            }
            
            if (amount > currentUser.balance) {
                showNotification('Insufficient balance', 'error');
                return;
            }
            
            if (!account) {
                showNotification('Please enter account number', 'error');
                return;
            }
            
            const transactions = getTransactions();
            const newTransaction = {
                id: transactions.length > 0 ? Math.max(...transactions.map(t => t.id)) + 1 : 1,
                userId: currentUser.id,
                type: 'withdrawal',
                amount: amount,
                status: 'pending',
                date: new Date().toISOString().replace('T', ' ').substr(0, 19),
                method: method,
                account: account
            };
            
            transactions.push(newTransaction);
            saveTransactions(transactions);
            
            // Update user balance (temporarily held)
            let users = getUsers();
            const userIndex = users.findIndex(u => u.id === currentUser.id);
            if (userIndex !== -1) {
                users[userIndex].balance -= amount;
                currentUser.balance -= amount;
                saveUsers(users);
                updateUserInfo();
            }
            
            // Create approval for admin
            const approvals = getApprovals();
            approvals.push({
                id: approvals.length > 0 ? Math.max(...approvals.map(a => a.id)) + 1 : 1,
                userId: currentUser.id,
                username: currentUser.username,
                type: 'withdrawal',
                amount: amount,
                method: method,
                account: account,
                status: 'pending',
                date: new Date().toISOString().split('T')[0],
                submittedAt: new Date().toISOString().replace('T', ' ').substr(0, 19)
            });
            
            saveApprovals(approvals);
            
            closeModal();
            showNotification(`Withdrawal of ${amount} ETB requested. Waiting for admin approval.`, 'success');
        }

        function showTransactionHistory() {
            const transactions = getTransactions();
            const userTransactions = transactions.filter(t => t.userId === currentUser.id);
            
            let historyHTML = '';
            
            if (userTransactions.length === 0) {
                historyHTML = `
                    <div style="text-align: center; padding: 40px 20px;">
                        <div style="font-size: 48px; color: #e5e7eb; margin-bottom: 20px;">
                            <i class="fas fa-history"></i>
                        </div>
                        <div style="color: #6b7280;">No transactions yet</div>
                    </div>
                `;
            } else {
                historyHTML = userTransactions.map(transaction => `
                    <div style="display: flex; justify-content: space-between; padding: 15px; border-bottom: 1px solid #e5e7eb;">
                        <div>
                            <div style="font-weight: 600;">${transaction.type === 'deposit' ? 'Deposit' : 'Withdrawal'}</div>
                            <div style="font-size: 14px; color: #6b7280;">${transaction.date}</div>
                            <div style="font-size: 12px; color: #9ca3af;">${transaction.method}</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-weight: 600; color: ${transaction.type === 'deposit' ? '#10b981' : '#ef4444'}">
                                ${transaction.type === 'deposit' ? '+' : '-'}${transaction.amount} ETB
                            </div>
                            <div style="font-size: 12px; color: ${transaction.status === 'completed' ? '#10b981' : transaction.status === 'pending' ? '#f59e0b' : '#ef4444'}">
                                ${transaction.status}
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            
            showModal('Transaction History', `
                <div style="max-height: 400px; overflow-y: auto;">
                    ${historyHTML}
                </div>
            `);
        }

        function loadHistory() {
            const transactions = getTransactions();
            const userTransactions = transactions.filter(t => t.userId === currentUser.id);
            
            let historyHTML = '';
            
            if (userTransactions.length === 0) {
                historyHTML = `
                    <div style="text-align: center; padding: 50px 20px;">
                        <div style="font-size: 48px; color: #e5e7eb; margin-bottom: 20px;">
                            <i class="fas fa-history"></i>
                        </div>
                        <div style="font-size: 18px; color: #6b7280; margin-bottom: 10px;">
                            No history yet
                        </div>
                        <div style="color: #9ca3af;">
                            Start completing works to see your history
                        </div>
                    </div>
                `;
            } else {
                historyHTML = userTransactions.map(transaction => `
                    <div style="background: white; border-radius: 10px; padding: 20px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.05);">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <div style="font-weight: 600;">${transaction.type === 'deposit' ? 'Deposit' : 
                                transaction.type === 'withdrawal' ? 'Withdrawal' : 
                                'Work: ' + (transaction.workTitle || '')}</div>
                            <div style="font-weight: 600; color: ${transaction.type === 'deposit' || transaction.type === 'work' ? '#10b981' : '#ef4444'}">
                                ${transaction.type === 'deposit' || transaction.type === 'work' ? '+' : '-'}${transaction.amount} ETB
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-size: 14px; color: #6b7280;">
                            <div>${transaction.date}</div>
                            <div style="color: ${transaction.status === 'completed' ? '#10b981' : transaction.status === 'pending' ? '#f59e0b' : '#ef4444'}">
                                ${transaction.status}
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            
            const content = `
                <div class="page-title">History</div>
                <div class="page-subtitle">Your transaction and work history</div>
                ${historyHTML}
            `;
            
            document.getElementById('app-main').innerHTML = content;
        }

        function loadReferrals() {
            const content = `
                <div class="page-title">Referrals</div>
                <div class="page-subtitle">Invite friends and earn more</div>
                
                <div style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); color: white; border-radius: 15px; padding: 30px; margin-bottom: 30px;">
                    <div style="font-size: 24px; font-weight: 600; margin-bottom: 10px;">Earn 10% Commission</div>
                    <div style="opacity: 0.9; margin-bottom: 20px;">
                        Invite friends and earn 10% of their earnings
                    </div>
                    
                    <div style="display: flex; gap: 15px; margin-bottom: 20px;">
                        <div style="flex: 1; background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px;">
                            <div style="font-size: 14px; opacity: 0.8;">Your Referrals</div>
                            <div style="font-size: 24px; font-weight: 600;">${currentUser.referrals}</div>
                        </div>
                        <div style="flex: 1; background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px;">
                            <div style="font-size: 14px; opacity: 0.8;">Earned from Referrals</div>
                            <div style="font-size: 24px; font-weight: 600;">${currentUser.referrals * 50} ETB</div>
                        </div>
                    </div>
                </div>
                
                <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); margin-bottom: 30px;">
                    <div style="font-size: 18px; font-weight: 600; margin-bottom: 15px;">Your Referral Link</div>
                    
                    <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                        <input type="text" value="https://ethioworks.et/ref/${currentUser.referralCode}" 
                               style="flex: 1; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 14px;" readonly>
                        <button class="btn" onclick="copyReferralLink()" style="width: auto; padding: 12px 20px;">
                            Copy
                        </button>
                    </div>
                    
                    <div style="font-size: 14px; color: #6b7280;">
                        Share this link with friends. When they sign up and start earning, you'll get 10% of their earnings.
                    </div>
                </div>
                
                <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.05);">
                    <div style="font-size: 18px; font-weight: 600; margin-bottom: 20px;">How It Works</div>
                    
                    <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                        <div style="flex: 1; text-align: center;">
                            <div style="width: 50px; height: 50px; background: #4f46e5; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin: 0 auto 10px;">1</div>
                            <div style="font-weight: 600; margin-bottom: 5px;">Share Your Link</div>
                            <div style="font-size: 14px; color: #6b7280;">Share with friends and family</div>
                        </div>
                        <div style="flex: 1; text-align: center;">
                            <div style="width: 50px; height: 50px; background: #4f46e5; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin: 0 auto 10px;">2</div>
                            <div style="font-weight: 600; margin-bottom: 5px;">They Sign Up</div>
                            <div style="font-size: 14px; color: #6b7280;">They register using your link</div>
                        </div>
                        <div style="flex: 1; text-align: center;">
                            <div style="width: 50px; height: 50px; background: #4f46e5; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin: 0 auto 10px;">3</div>
                            <div style="font-weight: 600; margin-bottom: 5px;">You Earn</div>
                            <div style="font-size: 14px; color: #6b7280;">Get 10% of their earnings</div>
                        </div>
                    </div>
                </div>
            `;
            
            document.getElementById('app-main').innerHTML = content;
        }

        function copyReferralLink() {
            const link = `https://ethioworks.et/ref/${currentUser.referralCode}`;
            navigator.clipboard.writeText(link).then(() => {
                showNotification('Link copied to clipboard!', 'success');
            }).catch(() => {
                showNotification('Failed to copy link', 'error');
            });
        }

        function loadAccount() {
            const content = `
                <div class="page-title">Account</div>
                <div class="page-subtitle">Manage your profile and settings</div>
                
                <div class="profile-section">
                    <div class="profile-avatar">
                        ${currentUser.name.charAt(0).toUpperCase()}
                    </div>
                    <div class="profile-info">
                        <div class="profile-name">${currentUser.name}</div>
                        <div class="profile-username">@${currentUser.username}</div>
                        
                        <div class="info-grid">
                            <div class="info-item">
                                <div class="info-label">Phone</div>
                                <div class="info-value">${currentUser.phone}</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Join Date</div>
                                <div class="info-value">${currentUser.joinDate}</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Status</div>
                                <div class="info-value" style="color: #10b981;">Active</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Referral Code</div>
                                <div class="info-value">${currentUser.referralCode}</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); margin-bottom: 20px;">
                    <div style="font-size: 18px; font-weight: 600; margin-bottom: 20px;">Update Profile</div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Full Name</label>
                            <input type="text" class="form-control" value="${currentUser.name}">
                        </div>
                        <div class="form-group">
                            <label>Phone Number</label>
                            <input type="tel" class="form-control" value="${currentUser.phone}">
                        </div>
                    </div>
                    
                    <button class="btn" onclick="updateProfile()">
                        Update Profile
                    </button>
                </div>
                
                <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.05);">
                    <div style="font-size: 18px; font-weight: 600; margin-bottom: 20px;">Security</div>
                    
                    <div class="form-group">
                        <label>Current Password</label>
                        <input type="password" class="form-control" placeholder="Enter current password">
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>New Password</label>
                            <input type="password" class="form-control" placeholder="Enter new password">
                        </div>
                        <div class="form-group">
                            <label>Confirm Password</label>
                            <input type="password" class="form-control" placeholder="Confirm new password">
                        </div>
                    </div>
                    
                    <button class="btn" onclick="changePassword()">
                        Change Password
                    </button>
                </div>
                
                <button class="btn" onclick="logout()" style="width: 100%; margin-top: 20px; background: #ef4444;">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            `;
            
            document.getElementById('app-main').innerHTML = content;
        }

        function updateProfile() {
            showNotification('Profile updated successfully!', 'success');
        }

        function changePassword() {
            showNotification('Password changed successfully!', 'success');
        }

        function showSettings() {
            showModal('Settings', `
                <div style="margin-bottom: 20px;">
                    <div style="font-size: 16px; font-weight: 600; margin-bottom: 15px;">Notifications</div>
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; background: #f9fafb; border-radius: 10px; margin-bottom: 10px;">
                        <div>
                            <div style="font-weight: 500;">Email Notifications</div>
                            <div style="font-size: 14px; color: #6b7280;">Receive email updates</div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; background: #f9fafb; border-radius: 10px; margin-bottom: 10px;">
                        <div>
                            <div style="font-weight: 500;">SMS Notifications</div>
                            <div style="font-size: 14px; color: #6b7280;">Receive SMS updates</div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                
                <div>
                    <div style="font-size: 16px; font-weight: 600; margin-bottom: 15px;">Privacy</div>
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; background: #f9fafb; border-radius: 10px; margin-bottom: 10px;">
                        <div>
                            <div style="font-weight: 500;">Show Online Status</div>
                            <div style="font-size: 14px; color: #6b7280;">Let others see you're online</div>
                        </div>
                        <label class="switch">
                            <input type="checkbox">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
            `);
            
            // Add switch styles
            const style = document.createElement('style');
            style.textContent = `
                .switch {
                    position: relative;
                    display: inline-block;
                    width: 50px;
                    height: 24px;
                }
                
                .switch input {
                    opacity: 0;
                    width: 0;
                    height: 0;
                }
                
                .slider {
                    position: absolute;
                    cursor: pointer;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background-color: #ccc;
                    transition: .4s;
                    border-radius: 34px;
                }
                
                .slider:before {
                    position: absolute;
                    content: "";
                    height: 16px;
                    width: 16px;
                    left: 4px;
                    bottom: 4px;
                    background-color: white;
                    transition: .4s;
                    border-radius: 50%;
                }
                
                input:checked + .slider {
                    background-color: #4f46e5;
                }
                
                input:checked + .slider:before {
                    transform: translateX(26px);
                }
            `;
            document.head.appendChild(style);
        }

        // Admin Pages
        function loadAdminDashboard() {
            const users = getUsers();
            const works = getWorks();
            const transactions = getTransactions();
            const approvals = getApprovals();
            
            const totalUsers = users.length;
            const activeUsers = users.filter(u => u.status === 'active').length;
            const totalWorks = works.length;
            const activeWorks = works.filter(w => w.status === 'active').length;
            const pendingApprovals = approvals.filter(a => a.status === 'pending').length;
            const totalRevenue = transactions
                .filter(t => t.type === 'deposit' && t.status === 'completed')
                .reduce((sum, t) => sum + t.amount, 0);
            const totalPayouts = transactions
                .filter(t => t.type === 'withdrawal' && t.status === 'completed')
                .reduce((sum, t) => sum + t.amount, 0);
            const netProfit = totalRevenue - totalPayouts;
            
            const content = `
                <div class="page-title">Admin Dashboard</div>
                <div class="page-subtitle">Welcome, ${currentUser.name}</div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(79, 70, 229, 0.1); color: #4f46e5;">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-value">${totalUsers}</div>
                        <div class="stat-label">Total Users</div>
                        <div style="font-size: 12px; color: #10b981;">${activeUsers} active</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(16, 185, 129, 0.1); color: #10b981;">
                            <i class="fas fa-tasks"></i>
                        </div>
                        <div class="stat-value">${totalWorks}</div>
                        <div class="stat-label">Total Works</div>
                        <div style="font-size: 12px; color: #10b981;">${activeWorks} active</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(245, 158, 11, 0.1); color: #f59e0b;">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-value">${pendingApprovals}</div>
                        <div class="stat-label">Pending Approvals</div>
                        <div style="font-size: 12px; color: #f59e0b;">Needs review</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(239, 68, 68, 0.1); color: #ef4444;">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-value">${netProfit} ETB</div>
                        <div class="stat-label">Net Profit</div>
                        <div style="font-size: 12px; color: #10b981;">${totalRevenue} ETB revenue</div>
                    </div>
                </div>
                
                <div style="margin-top: 30px;">
                    <div style="font-size: 20px; font-weight: 600; margin-bottom: 20px;">Quick Actions</div>
                    <div class="actions-grid">
                        <div class="action-card" onclick="showAdminPage('approvals')">
                            <div class="action-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="action-title">Review Approvals</div>
                            <div class="action-desc">${pendingApprovals} pending</div>
                        </div>
                        
                        <div class="action-card" onclick="showAdminPage('users')">
                            <div class="action-icon">
                                <i class="fas fa-user-plus"></i>
                            </div>
                            <div class="action-title">Manage Users</div>
                            <div class="action-desc">${totalUsers} users</div>
                        </div>
                        
                        <div class="action-card" onclick="showAdminPage('works')">
                            <div class="action-icon">
                                <i class="fas fa-plus-circle"></i>
                            </div>
                            <div class="action-title">Create Work</div>
                            <div class="action-desc">Add new tasks</div>
                        </div>
                        
                        <div class="action-card" onclick="showAdminPage('transactions')">
                            <div class="action-icon">
                                <i class="fas fa-exchange-alt"></i>
                            </div>
                            <div class="action-title">Transactions</div>
                            <div class="action-desc">View all transactions</div>
                        </div>
                    </div>
                </div>
                
                <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); margin-top: 30px;">
                    <div style="font-size: 18px; font-weight: 600; margin-bottom: 20px;">Recent Activity</div>
                    
                    <div style="max-height: 300px; overflow-y: auto;">
                        ${approvals.slice(-5).reverse().map(approval => `
                            <div style="display: flex; justify-content: space-between; padding: 15px; border-bottom: 1px solid #e5e7eb;">
                                <div>
                                    <div style="font-weight: 500;">${approval.username} - ${approval.type}</div>
                                    <div style="font-size: 14px; color: #6b7280;">${approval.submittedAt || approval.date}</div>
                                </div>
                                <div>
                                    <span style="padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; 
                                          background: ${approval.status === 'pending' ? '#fef3c7' : approval.status === 'approved' ? '#d1fae5' : '#fee2e2'};
                                          color: ${approval.status === 'pending' ? '#d97706' : approval.status === 'approved' ? '#059669' : '#dc2626'}">
                                        ${approval.status}
                                    </span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            document.getElementById('admin-main').innerHTML = content;
        }

        function loadAdminUsers() {
            const users = getUsers();
            
            const content = `
                <div class="page-title">User Management</div>
                <div class="page-subtitle">Manage all system users</div>
                
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <input type="text" class="form-control" placeholder="Search users..." 
                           style="width: 300px;" onkeyup="searchUsers(this.value)">
                    <button class="btn" onclick="addNewUser()" style="width: auto;">
                        <i class="fas fa-plus"></i> Add User
                    </button>
                </div>
                
                <div style="background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.05);">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f9fafb;">
                                <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">ID</th>
                                <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">Name</th>
                                <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">Username</th>
                                <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">Balance</th>
                                <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">Level</th>
                                <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">Status</th>
                                <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="users-table">
                            ${users.map(user => `
                                <tr style="border-bottom: 1px solid #e5e7eb;">
                                    <td style="padding: 15px;">${user.id}</td>
                                    <td style="padding: 15px;">${user.name}</td>
                                    <td style="padding: 15px;">${user.username}</td>
                                    <td style="padding: 15px;">${user.balance} ETB</td>
                                    <td style="padding: 15px;">${user.level}</td>
                                    <td style="padding: 15px;">
                                        <span style="padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; 
                                              background: ${user.status === 'active' ? '#d1fae5' : user.status === 'suspended' ? '#fef3c7' : '#fee2e2'};
                                              color: ${user.status === 'active' ? '#059669' : user.status === 'suspended' ? '#d97706' : '#dc2626'}">
                                            ${user.status}
                                        </span>
                                    </td>
                                    <td style="padding: 15px;">
                                        <button onclick="viewUser(${user.id})" style="background: #4f46e5; color: white; border: none; padding: 5px 10px; border-radius: 5px; margin-right: 5px; cursor: pointer;">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button onclick="editUser(${user.id})" style="background: #f59e0b; color: white; border: none; padding: 5px 10px; border-radius: 5px; margin-right: 5px; cursor: pointer;">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button onclick="deleteUser(${user.id})" style="background: #ef4444; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer;">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
            
            document.getElementById('admin-main').innerHTML = content;
        }

        function searchUsers(query) {
            const users = getUsers();
            const filteredUsers = users.filter(user => 
                user.name.toLowerCase().includes(query.toLowerCase()) ||
                user.username.toLowerCase().includes(query.toLowerCase()) ||
                user.phone.includes(query)
            );
            
            const tableBody = document.getElementById('users-table');
            if (tableBody) {
                tableBody.innerHTML = filteredUsers.map(user => `
                    <tr style="border-bottom: 1px solid #e5e7eb;">
                        <td style="padding: 15px;">${user.id}</td>
                        <td style="padding: 15px;">${user.name}</td>
                        <td style="padding: 15px;">${user.username}</td>
                        <td style="padding: 15px;">${user.balance} ETB</td>
                        <td style="padding: 15px;">${user.level}</td>
                        <td style="padding: 15px;">
                            <span style="padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; 
                                  background: ${user.status === 'active' ? '#d1fae5' : user.status === 'suspended' ? '#fef3c7' : '#fee2e2'};
                                  color: ${user.status === 'active' ? '#059669' : user.status === 'suspended' ? '#d97706' : '#dc2626'}">
                                ${user.status}
                            </span>
                        </td>
                        <td style="padding: 15px;">
                            <button onclick="viewUser(${user.id})" style="background: #4f46e5; color: white; border: none; padding: 5px 10px; border-radius: 5px; margin-right: 5px; cursor: pointer;">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button onclick="editUser(${user.id})" style="background: #f59e0b; color: white; border: none; padding: 5px 10px; border-radius: 5px; margin-right: 5px; cursor: pointer;">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteUser(${user.id})" style="background: #ef4444; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer;">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `).join('');
            }
        }

        function addNewUser() {
            showModal('Add New User', `
                <div class="form-row">
                    <div class="form-group">
                        <label>Full Name</label>
                        <input type="text" id="admin-new-name" class="form-control" placeholder="Enter full name">
                    </div>
                    <div class="form-group">
                        <label>Username</label>
                        <input type="text" id="admin-new-username" class="form-control" placeholder="Enter username">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" id="admin-new-password" class="form-control" placeholder="Enter password">
                    </div>
                    <div class="form-group">
                        <label>Phone</label>
                        <input type="tel" id="admin-new-phone" class="form-control" placeholder="09XX XXX XXX">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Initial Balance (ETB)</label>
                        <input type="number" id="admin-new-balance" class="form-control" value="0">
                    </div>
                    <div class="form-group">
                        <label>Level</label>
                        <input type="number" id="admin-new-level" class="form-control" value="1" min="1" max="10">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Status</label>
                    <select id="admin-new-status" class="form-control">
                        <option value="active">Active</option>
                        <option value="suspended">Suspended</option>
                        <option value="banned">Banned</option>
                    </select>
                </div>
                
                <button class="btn" onclick="saveNewUser()">
                    <i class="fas fa-save"></i> Create User
                </button>
            `);
        }

        function saveNewUser() {
            const name = document.getElementById('admin-new-name').value.trim();
            const username = document.getElementById('admin-new-username').value.trim();
            const password = document.getElementById('admin-new-password').value.trim();
            const phone = document.getElementById('admin-new-phone').value.trim();
            const balance = parseInt(document.getElementById('admin-new-balance').value) || 0;
            const level = parseInt(document.getElementById('admin-new-level').value) || 1;
            const status = document.getElementById('admin-new-status').value;
            
            if (!name || !username || !password || !phone) {
                showNotification('Please fill all required fields', 'error');
                return;
            }
            
            let users = getUsers();
            
            if (users.find(u => u.username === username)) {
                showNotification('Username already exists', 'error');
                return;
            }
            
            if (password.length < 6) {
                showNotification('Password must be at least 6 characters', 'error');
                return;
            }
            
            const newUser = {
                id: users.length > 0 ? Math.max(...users.map(u => u.id)) + 1 : 1,
                name,
                username,
                password,
                phone,
                balance,
                level,
                worksCompleted: 0,
                joinDate: new Date().toISOString().split('T')[0],
                status,
                referralCode: "REF" + Math.floor(100000 + Math.random() * 900000),
                referrals: 0
            };
            
            users.push(newUser);
            saveUsers(users);
            
            closeModal();
            showNotification('User created successfully!', 'success');
            loadAdminUsers();
        }

        function viewUser(userId) {
            const users = getUsers();
            const user = users.find(u => u.id === userId);
            
            if (!user) return;
            
            showModal(`User: ${user.name}`, `
                <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 20px;">
                    <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 32px; color: white; font-weight: bold;">
                        ${user.name.charAt(0).toUpperCase()}
                    </div>
                    <div>
                        <div style="font-size: 24px; font-weight: 600;">${user.name}</div>
                        <div style="color: #6b7280;">@${user.username}</div>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 20px;">
                    <div style="background: #f9fafb; padding: 15px; border-radius: 10px;">
                        <div style="color: #6b7280; font-size: 14px;">Balance</div>
                        <div style="font-size: 20px; font-weight: 600;">${user.balance} ETB</div>
                    </div>
                    <div style="background: #f9fafb; padding: 15px; border-radius: 10px;">
                        <div style="color: #6b7280; font-size: 14px;">Level</div>
                        <div style="font-size: 20px; font-weight: 600;">${user.level}</div>
                    </div>
                    <div style="background: #f9fafb; padding: 15px; border-radius: 10px;">
                        <div style="color: #6b7280; font-size: 14px;">Works Completed</div>
                        <div style="font-size: 20px; font-weight: 600;">${user.worksCompleted}</div>
                    </div>
                    <div style="background: #f9fafb; padding: 15px; border-radius: 10px;">
                        <div style="color: #6b7280; font-size: 14px;">Referrals</div>
                        <div style="font-size: 20px; font-weight: 600;">${user.referrals}</div>
                    </div>
                </div>
                
                <div style="background: #f9fafb; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                    <div style="color: #6b7280; font-size: 14px; margin-bottom: 10px;">Details</div>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                        <div>
                            <div style="font-size: 12px; color: #6b7280;">Phone</div>
                            <div style="font-weight: 500;">${user.phone}</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6b7280;">Join Date</div>
                            <div style="font-weight: 500;">${user.joinDate}</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6b7280;">Status</div>
                            <div style="font-weight: 500; color: ${user.status === 'active' ? '#059669' : user.status === 'suspended' ? '#d97706' : '#dc2626'}">
                                ${user.status}
                            </div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6b7280;">Referral Code</div>
                            <div style="font-weight: 500;">${user.referralCode}</div>
                        </div>
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <button class="btn" onclick="editUser(${user.id}); closeModal();" style="flex: 1;">
                        <i class="fas fa-edit"></i> Edit User
                    </button>
                    <button class="btn" onclick="closeModal()" style="flex: 1; background: #e5e7eb; color: #374151;">
                        Close
                    </button>
                </div>
            `);
        }

        function editUser(userId) {
            const users = getUsers();
            const user = users.find(u => u.id === userId);
            
            if (!user) return;
            
            showModal('Edit User', `
                <div class="form-row">
                    <div class="form-group">
                        <label>Full Name</label>
                        <input type="text" id="admin-edit-name" class="form-control" value="${user.name}">
                    </div>
                    <div class="form-group">
                        <label>Username</label>
                        <input type="text" id="admin-edit-username" class="form-control" value="${user.username}">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Password (leave blank to keep)</label>
                        <input type="password" id="admin-edit-password" class="form-control" placeholder="Enter new password">
                    </div>
                    <div class="form-group">
                        <label>Phone</label>
                        <input type="tel" id="admin-edit-phone" class="form-control" value="${user.phone}">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Balance (ETB)</label>
                        <input type="number" id="admin-edit-balance" class="form-control" value="${user.balance}">
                    </div>
                    <div class="form-group">
                        <label>Level</label>
                        <input type="number" id="admin-edit-level" class="form-control" value="${user.level}" min="1" max="10">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Status</label>
                    <select id="admin-edit-status" class="form-control">
                        <option value="active" ${user.status === 'active' ? 'selected' : ''}>Active</option>
                        <option value="suspended" ${user.status === 'suspended' ? 'selected' : ''}>Suspended</option>
                        <option value="banned" ${user.status === 'banned' ? 'selected' : ''}>Banned</option>
                    </select>
                </div>
                
                <button class="btn" onclick="saveUserChanges(${user.id})">
                    <i class="fas fa-save"></i> Save Changes
                </button>
            `);
        }

        function saveUserChanges(userId) {
            let users = getUsers();
            const userIndex = users.findIndex(u => u.id === userId);
            
            if (userIndex === -1) return;
            
            users[userIndex].name = document.getElementById('admin-edit-name').value.trim();
            users[userIndex].username = document.getElementById('admin-edit-username').value.trim();
            const newPassword = document.getElementById('admin-edit-password').value.trim();
            if (newPassword) {
                users[userIndex].password = newPassword;
            }
            users[userIndex].phone = document.getElementById('admin-edit-phone').value.trim();
            users[userIndex].balance = parseInt(document.getElementById('admin-edit-balance').value) || 0;
            users[userIndex].level = parseInt(document.getElementById('admin-edit-level').value) || 1;
            users[userIndex].status = document.getElementById('admin-edit-status').value;
            
            saveUsers(users);
            closeModal();
            showNotification('User updated successfully!', 'success');
            loadAdminUsers();
        }

        function deleteUser(userId) {
            if (userId === currentUser.id) {
                showNotification('Cannot delete your own account', 'error');
                return;
            }
            
            if (confirm('Are you sure you want to delete this user? This action cannot be undone.')) {
                let users = getUsers();
                users = users.filter(u => u.id !== userId);
                saveUsers(users);
                showNotification('User deleted successfully!', 'success');
                loadAdminUsers();
            }
        }

        function loadAdminWorks() {
            const works = getWorks();
            
            const content = `
                <div class="page-title">Work Management</div>
                <div class="page-subtitle">Create and manage tasks</div>
                
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <div style="display: flex; gap: 10px;">
                        <button class="btn ${works.filter(w => w.status === 'active').length === works.length ? 'active' : ''}" 
                                onclick="filterWorks('all')" style="width: auto;">
                            All (${works.length})
                        </button>
                        <button class="btn" onclick="filterWorks('active')" style="width: auto;">
                            Active (${works.filter(w => w.status === 'active').length})
                        </button>
                        <button class="btn" onclick="filterWorks('inactive')" style="width: auto;">
                            Inactive (${works.filter(w => w.status !== 'active').length})
                        </button>
                    </div>
                    <button class="btn" onclick="createNewWork()" style="width: auto;">
                        <i class="fas fa-plus"></i> Create Work
                    </button>
                </div>
                
                <div class="works-grid" id="works-container">
                    ${works.map(work => `
                        <div class="work-card">
                            <div class="work-header">
                                <div class="work-title">${work.title}</div>
                                <div class="work-reward">${work.reward} ETB</div>
                            </div>
                            <div class="work-body">
                                <div class="work-description">
                                    ${work.description}
                                </div>
                                <div class="work-meta">
                                    <span>
                                        <i class="fas fa-signal"></i>
                                        ${work.difficulty}
                                    </span>
                                    <span>
                                        <i class="fas fa-clock"></i>
                                        ${work.time}
                                    </span>
                                    <span>
                                        <i class="fas fa-box"></i>
                                        ${work.available} available
                                    </span>
                                </div>
                                <div class="work-actions">
                                    <button class="btn-small btn-secondary" onclick="editWork(${work.id})">
                                        Edit
                                    </button>
                                    <button class="btn-small ${work.status === 'active' ? 'btn-warning' : 'btn-success'}" 
                                            onclick="toggleWorkStatus(${work.id})" 
                                            style="${work.status === 'active' ? 'background: #f59e0b;' : 'background: #10b981;'}">
                                        ${work.status === 'active' ? 'Deactivate' : 'Activate'}
                                    </button>
                                    <button class="btn-small btn-danger" onclick="deleteWork(${work.id})" 
                                            style="background: #ef4444;">
                                        Delete
                                    </button>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
            
            document.getElementById('admin-main').innerHTML = content;
        }

        function filterWorks(filter) {
            const works = getWorks();
            let filteredWorks = works;
            
            if (filter === 'active') {
                filteredWorks = works.filter(w => w.status === 'active');
            } else if (filter === 'inactive') {
                filteredWorks = works.filter(w => w.status !== 'active');
            }
            
            const container = document.getElementById('works-container');
            if (container) {
                container.innerHTML = filteredWorks.map(work => `
                    <div class="work-card">
                        <div class="work-header">
                            <div class="work-title">${work.title}</div>
                            <div class="work-reward">${work.reward} ETB</div>
                        </div>
                        <div class="work-body">
                            <div class="work-description">
                                ${work.description}
                            </div>
                            <div class="work-meta">
                                <span>
                                    <i class="fas fa-signal"></i>
                                    ${work.difficulty}
                                </span>
                                <span>
                                    <i class="fas fa-clock"></i>
                                    ${work.time}
                                </span>
                                <span>
                                    <i class="fas fa-box"></i>
                                    ${work.available} available
                                </span>
                            </div>
                            <div class="work-actions">
                                <button class="btn-small btn-secondary" onclick="editWork(${work.id})">
                                    Edit
                                </button>
                                <button class="btn-small ${work.status === 'active' ? 'btn-warning' : 'btn-success'}" 
                                        onclick="toggleWorkStatus(${work.id})" 
                                        style="${work.status === 'active' ? 'background: #f59e0b;' : 'background: #10b981;'}">
                                    ${work.status === 'active' ? 'Deactivate' : 'Activate'}
                                </button>
                                <button class="btn-small btn-danger" onclick="deleteWork(${work.id})" 
                                        style="background: #ef4444;">
                                    Delete
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        }

        function createNewWork() {
            showModal('Create New Work', `
                <div class="form-group">
                    <label>Work Title</label>
                    <input type="text" id="new-work-title" class="form-control" placeholder="e.g., Like YouTube Videos">
                </div>
                
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="new-work-description" class="form-control" rows="3" placeholder="Describe the work..."></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Reward (ETB)</label>
                        <input type="number" id="new-work-reward" class="form-control" value="25" min="1">
                    </div>
                    <div class="form-group">
                        <label>Difficulty</label>
                        <select id="new-work-difficulty" class="form-control">
                            <option value="Easy">Easy</option>
                            <option value="Medium">Medium</option>
                            <option value="Hard">Hard</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Available Slots</label>
                        <input type="number" id="new-work-available" class="form-control" value="100" min="1">
                    </div>
                    <div class="form-group">
                        <label>Estimated Time</label>
                        <input type="text" id="new-work-time" class="form-control" value="5-10 minutes">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Category</label>
                    <input type="text" id="new-work-category" class="form-control" value="social" placeholder="e.g., social, survey, watch">
                </div>
                
                <div class="form-group">
                    <label>Requirements</label>
                    <textarea id="new-work-requirements" class="form-control" rows="2" placeholder="Requirements for this work..."></textarea>
                </div>
                
                <button class="btn" onclick="saveNewWork()">
                    <i class="fas fa-save"></i> Create Work
                </button>
            `);
        }

        function saveNewWork() {
            const title = document.getElementById('new-work-title').value.trim();
            const description = document.getElementById('new-work-description').value.trim();
            const reward = parseInt(document.getElementById('new-work-reward').value) || 25;
            const difficulty = document.getElementById('new-work-difficulty').value;
            const available = parseInt(document.getElementById('new-work-available').value) || 100;
            const time = document.getElementById('new-work-time').value.trim() || '5-10 minutes';
            const category = document.getElementById('new-work-category').value.trim() || 'social';
            const requirements = document.getElementById('new-work-requirements').value.trim();
            
            if (!title || !description) {
                showNotification('Please fill required fields', 'error');
                return;
            }
            
            let works = getWorks();
            
            const newWork = {
                id: works.length > 0 ? Math.max(...works.map(w => w.id)) + 1 : 1,
                title,
                description,
                reward,
                difficulty,
                available,
                completed: 0,
                status: 'active',
                category,
                requirements: requirements || 'Smartphone or computer with internet',
                time
            };
            
            works.push(newWork);
            saveWorks(works);
            
            closeModal();
            showNotification('Work created successfully!', 'success');
            loadAdminWorks();
        }

        function editWork(workId) {
            const works = getWorks();
            const work = works.find(w => w.id === workId);
            
            if (!work) return;
            
            showModal('Edit Work', `
                <div class="form-group">
                    <label>Work Title</label>
                    <input type="text" id="edit-work-title" class="form-control" value="${work.title}">
                </div>
                
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="edit-work-description" class="form-control" rows="3">${work.description}</textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Reward (ETB)</label>
                        <input type="number" id="edit-work-reward" class="form-control" value="${work.reward}" min="1">
                    </div>
                    <div class="form-group">
                        <label>Difficulty</label>
                        <select id="edit-work-difficulty" class="form-control">
                            <option value="Easy" ${work.difficulty === 'Easy' ? 'selected' : ''}>Easy</option>
                            <option value="Medium" ${work.difficulty === 'Medium' ? 'selected' : ''}>Medium</option>
                            <option value="Hard" ${work.difficulty === 'Hard' ? 'selected' : ''}>Hard</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Available Slots</label>
                        <input type="number" id="edit-work-available" class="form-control" value="${work.available}" min="0">
                    </div>
                    <div class="form-group">
                        <label>Estimated Time</label>
                        <input type="text" id="edit-work-time" class="form-control" value="${work.time}">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Category</label>
                    <input type="text" id="edit-work-category" class="form-control" value="${work.category}">
                </div>
                
                <div class="form-group">
                    <label>Requirements</label>
                    <textarea id="edit-work-requirements" class="form-control" rows="2">${work.requirements}</textarea>
                </div>
                
                <div class="form-group">
                    <label>Status</label>
                    <select id="edit-work-status" class="form-control">
                        <option value="active" ${work.status === 'active' ? 'selected' : ''}>Active</option>
                        <option value="inactive" ${work.status === 'inactive' ? 'selected' : ''}>Inactive</option>
                        <option value="paused" ${work.status === 'paused' ? 'selected' : ''}>Paused</option>
                    </select>
                </div>
                
                <button class="btn" onclick="saveWorkChanges(${work.id})">
                    <i class="fas fa-save"></i> Save Changes
                </button>
            `);
        }

        function saveWorkChanges(workId) {
            let works = getWorks();
            const workIndex = works.findIndex(w => w.id === workId);
            
            if (workIndex === -1) return;
            
            works[workIndex].title = document.getElementById('edit-work-title').value.trim();
            works[workIndex].description = document.getElementById('edit-work-description').value.trim();
            works[workIndex].reward = parseInt(document.getElementById('edit-work-reward').value) || 25;
            works[workIndex].difficulty = document.getElementById('edit-work-difficulty').value;
            works[workIndex].available = parseInt(document.getElementById('edit-work-available').value) || 0;
            works[workIndex].time = document.getElementById('edit-work-time').value.trim();
            works[workIndex].category = document.getElementById('edit-work-category').value.trim();
            works[workIndex].requirements = document.getElementById('edit-work-requirements').value.trim();
            works[workIndex].status = document.getElementById('edit-work-status').value;
            
            saveWorks(works);
            closeModal();
            showNotification('Work updated successfully!', 'success');
            loadAdminWorks();
        }

        function toggleWorkStatus(workId) {
            let works = getWorks();
            const workIndex = works.findIndex(w => w.id === workId);
            
            if (workIndex === -1) return;
            
            works[workIndex].status = works[workIndex].status === 'active' ? 'inactive' : 'active';
            saveWorks(works);
            
            showNotification(`Work ${works[workIndex].status === 'active' ? 'activated' : 'deactivated'}!`, 'success');
            loadAdminWorks();
        }

        function deleteWork(workId) {
            if (confirm('Are you sure you want to delete this work? This action cannot be undone.')) {
                let works = getWorks();
                works = works.filter(w => w.id !== workId);
                saveWorks(works);
                showNotification('Work deleted successfully!', 'success');
                loadAdminWorks();
            }
        }

        function loadAdminTransactions() {
            const transactions = getTransactions();
            const approvals = getApprovals();
            
            const pendingDeposits = approvals.filter(a => a.type === 'deposit' && a.status === 'pending');
            const pendingWithdrawals = approvals.filter(a => a.type === 'withdrawal' && a.status === 'pending');
            
            const content = `
                <div class="page-title">Transactions</div>
                <div class="page-subtitle">Manage all financial transactions</div>
                
                <div class="stats-grid" style="margin-bottom: 30px;">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(16, 185, 129, 0.1); color: #10b981;">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                        <div class="stat-value">${pendingDeposits.length}</div>
                        <div class="stat-label">Pending Deposits</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(239, 68, 68, 0.1); color: #ef4444;">
                            <i class="fas fa-arrow-up"></i>
                        </div>
                        <div class="stat-value">${pendingWithdrawals.length}</div>
                        <div class="stat-label">Pending Withdrawals</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(79, 70, 229, 0.1); color: #4f46e5;">
                            <i class="fas fa-exchange-alt"></i>
                        </div>
                        <div class="stat-value">${transactions.length}</div>
                        <div class="stat-label">Total Transactions</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(245, 158, 11, 0.1); color: #f59e0b;">
                            <i class="fas fa-filter"></i>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button onclick="filterTransactions('all')" style="flex: 1; padding: 5px; background: #f3f4f6; border: none; border-radius: 5px; cursor: pointer;">All</button>
                            <button onclick="filterTransactions('deposit')" style="flex: 1; padding: 5px; background: #f3f4f6; border: none; border-radius: 5px; cursor: pointer;">Deposits</button>
                            <button onclick="filterTransactions('withdrawal')" style="flex: 1; padding: 5px; background: #f3f4f6; border: none; border-radius: 5px; cursor: pointer;">Withdrawals</button>
                        </div>
                    </div>
                </div>
                
                <div style="background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.05);">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f9fafb;">
                                <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">ID</th>
                                <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">User</th>
                                <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">Type</th>
                                <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">Amount</th>
                                <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">Method</th>
                                <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">Date</th>
                                <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">Status</th>
                                <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="transactions-table">
                            ${transactions.slice().reverse().map(transaction => {
                                const users = getUsers();
                                const user = users.find(u => u.id === transaction.userId);
                                return `
                                <tr style="border-bottom: 1px solid #e5e7eb;">
                                    <td style="padding: 15px;">${transaction.id}</td>
                                    <td style="padding: 15px;">${user ? user.name : 'Unknown'}</td>
                                    <td style="padding: 15px;">
                                        <span style="padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600;
                                              background: ${transaction.type === 'deposit' ? '#d1fae5' : '#fee2e2'};
                                              color: ${transaction.type === 'deposit' ? '#059669' : '#dc2626'}">
                                            ${transaction.type}
                                        </span>
                                    </td>
                                    <td style="padding: 15px; font-weight: 600;">${transaction.amount} ETB</td>
                                    <td style="padding: 15px;">${transaction.method}</td>
                                    <td style="padding: 15px;">${transaction.date}</td>
                                    <td style="padding: 15px;">
                                        <span style="padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600;
                                              background: ${transaction.status === 'completed' ? '#d1fae5' : transaction.status === 'pending' ? '#fef3c7' : '#fee2e2'};
                                              color: ${transaction.status === 'completed' ? '#059669' : transaction.status === 'pending' ? '#d97706' : '#dc2626'}">
                                            ${transaction.status}
                                        </span>
                                    </td>
                                    <td style="padding: 15px;">
                                        ${transaction.status === 'pending' ? `
                                            <button onclick="approveTransaction(${transaction.id})" style="background: #10b981; color: white; border: none; padding: 5px 10px; border-radius: 5px; margin-right: 5px; cursor: pointer;">
                                                Approve
                                            </button>
                                            <button onclick="rejectTransaction(${transaction.id})" style="background: #ef4444; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer;">
                                                Reject
                                            </button>
                                        ` : 'Completed'}
                                    </td>
                                </tr>
                            `}).join('')}
                        </tbody>
                    </table>
                </div>
            `;
            
            document.getElementById('admin-main').innerHTML = content;
        }

        function filterTransactions(type) {
            const transactions = getTransactions();
            let filteredTransactions = transactions;
            
            if (type !== 'all') {
                filteredTransactions = transactions.filter(t => t.type === type);
            }
            
            const table = document.getElementById('transactions-table');
            if (table) {
                const users = getUsers();
                table.innerHTML = filteredTransactions.slice().reverse().map(transaction => {
                    const user = users.find(u => u.id === transaction.userId);
                    return `
                    <tr style="border-bottom: 1px solid #e5e7eb;">
                        <td style="padding: 15px;">${transaction.id}</td>
                        <td style="padding: 15px;">${user ? user.name : 'Unknown'}</td>
                        <td style="padding: 15px;">
                            <span style="padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600;
                                  background: ${transaction.type === 'deposit' ? '#d1fae5' : '#fee2e2'};
                                  color: ${transaction.type === 'deposit' ? '#059669' : '#dc2626'}">
                                ${transaction.type}
                            </span>
                        </td>
                        <td style="padding: 15px; font-weight: 600;">${transaction.amount} ETB</td>
                        <td style="padding: 15px;">${transaction.method}</td>
                        <td style="padding: 15px;">${transaction.date}</td>
                        <td style="padding: 15px;">
                            <span style="padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600;
                                  background: ${transaction.status === 'completed' ? '#d1fae5' : transaction.status === 'pending' ? '#fef3c7' : '#fee2e2'};
                                  color: ${transaction.status === 'completed' ? '#059669' : transaction.status === 'pending' ? '#d97706' : '#dc2626'}">
                                ${transaction.status}
                            </span>
                        </td>
                        <td style="padding: 15px;">
                            ${transaction.status === 'pending' ? `
                                <button onclick="approveTransaction(${transaction.id})" style="background: #10b981; color: white; border: none; padding: 5px 10px; border-radius: 5px; margin-right: 5px; cursor: pointer;">
                                    Approve
                                </button>
                                <button onclick="rejectTransaction(${transaction.id})" style="background: #ef4444; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer;">
                                    Reject
                                </button>
                            ` : 'Completed'}
                        </td>
                    </tr>
                `}).join('');
            }
        }

        function approveTransaction(transactionId) {
            let transactions = getTransactions();
            const transactionIndex = transactions.findIndex(t => t.id === transactionId);
            
            if (transactionIndex === -1) return;
            
            const transaction = transactions[transactionIndex];
            
            if (transaction.type === 'deposit') {
                let users = getUsers();
                const userIndex = users.findIndex(u => u.id === transaction.userId);
                if (userIndex !== -1) {
                    users[userIndex].balance += transaction.amount;
                    saveUsers(users);
                }
            }
            
            transactions[transactionIndex].status = 'completed';
            saveTransactions(transactions);
            
            // Update approvals
            let approvals = getApprovals();
            const approvalIndex = approvals.findIndex(a => 
                a.userId === transaction.userId && 
                a.amount === transaction.amount &&
                a.type === transaction.type &&
                a.status === 'pending'
            );
            
            if (approvalIndex !== -1) {
                approvals[approvalIndex].status = 'approved';
                saveApprovals(approvals);
            }
            
            showNotification(`Transaction #${transactionId} approved!`, 'success');
            loadAdminTransactions();
        }

        function rejectTransaction(transactionId) {
            let transactions = getTransactions();
            const transactionIndex = transactions.findIndex(t => t.id === transactionId);
            
            if (transactionIndex === -1) return;
            
            const transaction = transactions[transactionIndex];
            
            if (transaction.type === 'withdrawal') {
                // Return money to user if it's a withdrawal rejection
                let users = getUsers();
                const userIndex = users.findIndex(u => u.id === transaction.userId);
                if (userIndex !== -1) {
                    users[userIndex].balance += transaction.amount;
                    saveUsers(users);
                }
            }
            
            transactions[transactionIndex].status = 'rejected';
            saveTransactions(transactions);
            
            // Update approvals
            let approvals = getApprovals();
            const approvalIndex = approvals.findIndex(a => 
                a.userId === transaction.userId && 
                a.amount === transaction.amount &&
                a.type === transaction.type &&
                a.status === 'pending'
            );
            
            if (approvalIndex !== -1) {
                approvals[approvalIndex].status = 'rejected';
                saveApprovals(approvals);
            }
            
            showNotification(`Transaction #${transactionId} rejected!`, 'success');
            loadAdminTransactions();
        }

        function loadAdminApprovals() {
            const approvals = getApprovals();
            const pendingApprovals = approvals.filter(a => a.status === 'pending');
            
            const content = `
                <div class="page-title">Approval Requests</div>
                <div class="page-subtitle">Review and approve pending requests</div>
                
                <div class="stats-grid" style="margin-bottom: 30px;">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(245, 158, 11, 0.1); color: #f59e0b;">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-value">${pendingApprovals.length}</div>
                        <div class="stat-label">Pending Approvals</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(16, 185, 129, 0.1); color: #10b981;">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                        <div class="stat-value">${pendingApprovals.filter(a => a.type === 'deposit').length}</div>
                        <div class="stat-label">Pending Deposits</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(239, 68, 68, 0.1); color: #ef4444;">
                            <i class="fas fa-arrow-up"></i>
                        </div>
                        <div class="stat-value">${pendingApprovals.filter(a => a.type === 'withdrawal').length}</div>
                        <div class="stat-label">Pending Withdrawals</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(79, 70, 229, 0.1); color: #4f46e5;">
                            <i class="fas fa-tasks"></i>
                        </div>
                        <div class="stat-value">${pendingApprovals.filter(a => a.type === 'work').length}</div>
                        <div class="stat-label">Work Submissions</div>
                    </div>
                </div>
                
                ${pendingApprovals.length === 0 ? `
                    <div style="text-align: center; padding: 50px 20px;">
                        <div style="font-size: 48px; color: #e5e7eb; margin-bottom: 20px;">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div style="font-size: 18px; color: #6b7280; margin-bottom: 10px;">
                            No pending approvals
                        </div>
                        <div style="color: #9ca3af;">
                            All requests have been processed
                        </div>
                    </div>
                ` : `
                    <div style="background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.05);">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: #f9fafb;">
                                    <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">ID</th>
                                    <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">User</th>
                                    <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">Type</th>
                                    <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">Details</th>
                                    <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">Amount</th>
                                    <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">Date</th>
                                    <th style="padding: 15px; text-align: left; border-bottom: 2px solid #e5e7eb;">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${pendingApprovals.map(approval => `
                                    <tr style="border-bottom: 1px solid #e5e7eb;">
                                        <td style="padding: 15px;">${approval.id}</td>
                                        <td style="padding: 15px;">
                                            <div style="font-weight: 600;">${approval.username}</div>
                                            <div style="font-size: 12px; color: #6b7280;">ID: ${approval.userId}</div>
                                        </td>
                                        <td style="padding: 15px;">
                                            <span style="padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600;
                                                  background: ${approval.type === 'deposit' ? '#d1fae5' : approval.type === 'withdrawal' ? '#fee2e2' : '#dbeafe'};
                                                  color: ${approval.type === 'deposit' ? '#059669' : approval.type === 'withdrawal' ? '#dc2626' : '#1d4ed8'}">
                                                ${approval.type}
                                            </span>
                                            ${approval.type === 'work' ? `<div style="font-size: 12px; color: #6b7280; margin-top: 5px;">${approval.workTitle}</div>` : ''}
                                        </td>
                                        <td style="padding: 15px;">
                                            ${approval.type === 'deposit' ? `
                                                <div style="font-size: 14px;">${approval.method || 'N/A'}</div>
                                                <div style="font-size: 12px; color: #6b7280;">${approval.phone || ''}</div>
                                            ` : approval.type === 'withdrawal' ? `
                                                <div style="font-size: 14px;">${approval.method || 'N/A'}</div>
                                                <div style="font-size: 12px; color: #6b7280;">${approval.account || ''}</div>
                                            ` : `
                                                <div style="font-size: 14px;">Work Submission</div>
                                                <div style="font-size: 12px; color: #6b7280;">Screenshots provided</div>
                                            `}
                                        </td>
                                        <td style="padding: 15px; font-weight: 600;">${approval.amount || 0} ETB</td>
                                        <td style="padding: 15px;">
                                            <div style="font-size: 14px;">${approval.date}</div>
                                            <div style="font-size: 12px; color: #6b7280;">${approval.submittedAt || ''}</div>
                                        </td>
                                        <td style="padding: 15px;">
                                            <button onclick="approveRequest(${approval.id})" style="background: #10b981; color: white; border: none; padding: 8px 15px; border-radius: 5px; margin-right: 5px; cursor: pointer; font-weight: 600;">
                                                Approve
                                            </button>
                                            <button onclick="rejectRequest(${approval.id})" style="background: #ef4444; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: 600;">
                                                Reject
                                            </button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `}
            `;
            
            document.getElementById('admin-main').innerHTML = content;
        }

        function approveRequest(approvalId) {
            let approvals = getApprovals();
            const approvalIndex = approvals.findIndex(a => a.id === approvalId);
            
            if (approvalIndex === -1) return;
            
            const approval = approvals[approvalIndex];
            
            if (approval.type === 'deposit') {
                let users = getUsers();
                const userIndex = users.findIndex(u => u.id === approval.userId);
                if (userIndex !== -1) {
                    users[userIndex].balance += approval.amount;
                    saveUsers(users);
                }
                
                // Add transaction
                let transactions = getTransactions();
                transactions.push({
                    id: transactions.length > 0 ? Math.max(...transactions.map(t => t.id)) + 1 : 1,
                    userId: approval.userId,
                    type: 'deposit',
                    amount: approval.amount,
                    status: 'completed',
                    date: new Date().toISOString().replace('T', ' ').substr(0, 19),
                    method: approval.method || 'N/A'
                });
                saveTransactions(transactions);
                
            } else if (approval.type === 'withdrawal') {
                // Transaction already exists, just update it
                let transactions = getTransactions();
                const transactionIndex = transactions.findIndex(t => 
                    t.userId === approval.userId && 
                    t.amount === approval.amount &&
                    t.type === 'withdrawal' &&
                    t.status === 'pending'
                );
                
                if (transactionIndex !== -1) {
                    transactions[transactionIndex].status = 'completed';
                    saveTransactions(transactions);
                }
                
            } else if (approval.type === 'work') {
                let users = getUsers();
                const userIndex = users.findIndex(u => u.id === approval.userId);
                if (userIndex !== -1) {
                    users[userIndex].balance += approval.reward;
                    users[userIndex].worksCompleted += 1;
                    saveUsers(users);
                }
                
                // Add transaction
                let transactions = getTransactions();
                transactions.push({
                    id: transactions.length > 0 ? Math.max(...transactions.map(t => t.id)) + 1 : 1,
                    userId: approval.userId,
                    type: 'work',
                    amount: approval.reward,
                    status: 'completed',
                    date: new Date().toISOString().replace('T', ' ').substr(0, 19),
                    workId: approval.workId,
                    workTitle: approval.workTitle
                });
                saveTransactions(transactions);
            }
            
            approvals[approvalIndex].status = 'approved';
            saveApprovals(approvals);
            
            showNotification(`Request #${approvalId} approved!`, 'success');
            loadAdminApprovals();
        }

        function rejectRequest(approvalId) {
            let approvals = getApprovals();
            const approvalIndex = approvals.findIndex(a => a.id === approvalId);
            
            if (approvalIndex === -1) return;
            
            const approval = approvals[approvalIndex];
            
            if (approval.type === 'withdrawal') {
                // Return money to user
                let users = getUsers();
                const userIndex = users.findIndex(u => u.id === approval.userId);
                if (userIndex !== -1) {
                    users[userIndex].balance += approval.amount;
                    saveUsers(users);
                }
            }
            
            approvals[approvalIndex].status = 'rejected';
            saveApprovals(approvals);
            
            showNotification(`Request #${approvalId} rejected!`, 'success');
            loadAdminApprovals();
        }

        function loadAdminSettings() {
            const content = `
                <div class="page-title">System Settings</div>
                <div class="page-subtitle">Configure platform settings</div>
                
                <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); margin-bottom: 20px;">
                    <div style="font-size: 18px; font-weight: 600; margin-bottom: 20px;">General Settings</div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Platform Name</label>
                            <input type="text" class="form-control" value="Ethio Online Works">
                        </div>
                        <div class="form-group">
                            <label>Currency</label>
                            <input type="text" class="form-control" value="ETB" readonly>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Minimum Withdrawal</label>
                            <input type="number" class="form-control" value="500">
                        </div>
                        <div class="form-group">
                            <label>Minimum Deposit</label>
                            <input type="number" class="form-control" value="100">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Referral Commission (%)</label>
                        <input type="number" class="form-control" value="10" min="1" max="50">
                    </div>
                    
                    <button class="btn" onclick="saveSettings()">
                        Save Settings
                    </button>
                </div>
                
                <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.05);">
                    <div style="font-size: 18px; font-weight: 600; margin-bottom: 20px;">Maintenance</div>
                    
                    <div style="margin-bottom: 20px;">
                        <div style="font-weight: 500; margin-bottom: 10px;">Backup Data</div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn" onclick="backupData()" style="width: auto;">
                                <i class="fas fa-download"></i> Download Backup
                            </button>
                            <button class="btn" onclick="restoreData()" style="width: auto; background: #f59e0b;">
                                <i class="fas fa-upload"></i> Restore Backup
                            </button>
                        </div>
                    </div>
                    
                    <div>
                        <div style="font-weight: 500; margin-bottom: 10px;">Reset System</div>
                        <div style="color: #ef4444; margin-bottom: 10px;">
                            <i class="fas fa-exclamation-triangle"></i> Warning: This will delete all data!
                        </div>
                        <button class="btn" onclick="resetSystem()" style="background: #ef4444;">
                            <i class="fas fa-trash"></i> Reset All Data
                        </button>
                    </div>
                </div>
            `;
            
            document.getElementById('admin-main').innerHTML = content;
        }

        function saveSettings() {
            showNotification('Settings saved successfully!', 'success');
        }

        function backupData() {
            const data = {
                users: getUsers(),
                works: getWorks(),
                transactions: getTransactions(),
                approvals: getApprovals(),
                timestamp: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ethio-works-backup-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('Backup downloaded successfully!', 'success');
        }

        function restoreData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = e => {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onload = event => {
                    try {
                        const data = JSON.parse(event.target.result);
                        
                        if (confirm('Are you sure you want to restore from backup? This will overwrite all current data.')) {
                            if (data.users) localStorage.setItem(STORAGE_KEYS.USERS, JSON.stringify(data.users));
                            if (data.works) localStorage.setItem(STORAGE_KEYS.WORKS, JSON.stringify(data.works));
                            if (data.transactions) localStorage.setItem(STORAGE_KEYS.TRANSACTIONS, JSON.stringify(data.transactions));
                            if (data.approvals) localStorage.setItem(STORAGE_KEYS.APPROVALS, JSON.stringify(data.approvals));
                            
                            showNotification('Data restored successfully!', 'success');
                            location.reload();
                        }
                    } catch (error) {
                        showNotification('Invalid backup file', 'error');
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }

        function resetSystem() {
            if (confirm('Are you absolutely sure? This will delete ALL data and cannot be undone!')) {
                localStorage.clear();
                showNotification('All data has been reset!', 'success');
                setTimeout(() => location.reload(), 2000);
            }
        }

        // Logout
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                currentUser = null;
                localStorage.removeItem(STORAGE_KEYS.CURRENT_USER);
                
                document.getElementById('app-container').style.display = 'none';
                document.getElementById('admin-container').style.display = 'none';
                document.getElementById('login-container').style.display = 'flex';
                document.getElementById('signup-container').style.display = 'none';
                
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
                document.getElementById('signup-name').value = '';
                document.getElementById('signup-username').value = '';
                document.getElementById('signup-password').value = '';
                document.getElementById('signup-phone').value = '';
                
                closeModal();
                showNotification('Logged out successfully', 'success');
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initializeData();
            
            const savedUser = localStorage.getItem(STORAGE_KEYS.CURRENT_USER);
            if (savedUser) {
                const user = JSON.parse(savedUser);
                if (user.isAdmin) {
                    showAdminPanel(user);
                } else {
                    showApp(user);
                }
            }
        });
    </script>
</body>
</html>